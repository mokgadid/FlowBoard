<div class="activity-page">
  <header class="page-header">
    <div class="title-wrap">
      <div class="title-glow"></div>
      <h2>Activity</h2>
    </div>
    <button
      id="back-to-dashboard"
      class="px-6 py-3 border border-purple-600 text-purple-600 font-semibold rounded-lg hover:bg-purple-100 transition-colors"
      type="button"
      aria-label="Back to Dashboard"
      (click)="goToDashboard()"
    >
      Back to Dashboard
    </button>
  </header>

  <section class="insights-grid">
    <!-- Completion Donut -->
    <article class="card chart-card flow-in">
      <div class="card-header">
        <h3>Overall Completion</h3>
        <span class="badge success">Live</span>
      </div>
      <div class="donut-wrap">
        <!-- Donut bound to component state -->
        <div
          class="donut"
          [style.--percent]="completionPercent"
          role="img"
          aria-label="Overall completion"
          [attr.aria-valuemin]="0"
          [attr.aria-valuemax]="100"
          [attr.aria-valuenow]="completionPercent"
        >
          <div class="donut-fill"></div>
          <div class="donut-center">
            <div class="donut-value">{{ completionPercent }}%</div>
            <div class="donut-caption">Completed</div>
          </div>
        </div>
        <ul class="legend">
          <li><span class="swatch swatch-done"></span>Completed <strong>({{ completedCount }})</strong></li>
          <li><span class="swatch swatch-pending"></span>Uncompleted <strong>({{ uncompletedCount }})</strong></li>
        </ul>
        <div class="progress-mini" aria-hidden="true">
          <div class="progress-done" [style.width.%]="completedSharePercent"></div>
          <div class="progress-pending" [style.width.%]="uncompletedSharePercent"></div>
        </div>
      </div>
    </article>

    <!-- Past Due Bar Chart -->
    <article class="card chart-card flow-in delay-1">
      <div class="card-header">
        <h3>Past-Due Tasks</h3>
        <span class="badge warning">Weekly</span>
      </div>
      <div class="bar-chart" role="img" aria-label="Past due tasks per day (last 7 days)">
        <div
          class="bar"
          *ngFor="let d of weekData"
          [style.--value]="d.percent"
          [attr.data-label]="d.label"
        >
          <span>{{ d.count }}</span>
        </div>
      </div>
    </article>
  </section>

  <!-- Activity Feed -->
  <section class="card feed-card fade-in">
    <div class="card-header">
      <h3>Activity Feed</h3>
    </div>
    <div class="feed timeline-line">
      <div class="feed-item" *ngFor="let f of feedItems">
        <div class="avatar" [class.alt]="f.kind === 'overdue'" aria-hidden="true">
          {{ f.kind === 'overdue' ? 'OD' : 'PD' }}
        </div>
        <div class="feed-body">
          <div class="feed-text">
            <strong>{{ f.kind === 'overdue' ? 'Overdue' : 'Pending' }}</strong> — {{ f.message }}
          </div>
          <div class="feed-time">{{ f.when | date:'short' }}</div>
        </div>
        <button type="button" class="feed-delete" aria-label="Delete feed item" (click)="deleteFeedItem(f.id)">
          ✕
        </button>
      </div>
      <div *ngIf="feedItems.length === 0" class="feed-empty text-sm text-gray-500 px-2 py-1">No recent activity</div>
    </div>
  </section>
</div>
